import { q as useUserInfoStore, B as useGameStore, r as reactExports, S as trans, K as jsxRuntimeExports, P as joinClass, R as Image, ad as getCountryFlag, aa as customToFixed, bw as getPlatBalance, a1 as postRecallbalance, a7 as Message } from "./index-a_Ow1xUN-2024_8_30_15_11.js";
import { G as GameTabs, g as gameTypeNames, k as LeftNav, y as mineCss } from "./App-D9NLPZJN-2024_8_30_15_11.js";
import { TudoIcons } from "./Tudos-Bq9UPBqF-2024_8_30_15_11.js";
const svg_theme_fill_color = "_svg_theme_fill_color_1rjvv_3";
const header = "_header_1rjvv_55";
const imgBg = "_imgBg_1rjvv_115";
const centarl = "_centarl_1rjvv_123";
const img = "_img_1rjvv_115";
const coin = "_coin_1rjvv_181";
const listContainer = "_listContainer_1rjvv_334";
const left_nav = "_left_nav_1rjvv_337";
const rightContainer = "_rightContainer_1rjvv_355";
const rightContainerContent = "_rightContainerContent_1rjvv_359";
const rightItem = "_rightItem_1rjvv_371";
const first = "_first_1rjvv_461";
const second = "_second_1rjvv_524";
const maintained = "_maintained_1rjvv_611";
const maintainedAvtive = "_maintainedAvtive_1rjvv_626";
const displayNone = "_displayNone_1rjvv_630";
const css = {
  svg_theme_fill_color,
  header,
  imgBg,
  centarl,
  img,
  coin,
  listContainer,
  left_nav,
  rightContainer,
  rightContainerContent,
  rightItem,
  first,
  second,
  maintained,
  maintainedAvtive,
  displayNone
};
const centerWallent = {
  black: "/home/icons/center_wallent_black.webp",
  blue: "/home/icons/center_wallent_blue.webp",
  whiteGreen: "/home/icons/center_wallent_white_green.webp",
  purple: "/home/icons/center_wallent_purple.webp",
  whiteRed: "/home/icons/center_wallent_white_red.webp",
  oilyGreen: "/home/icons/center_wallent_oily_green.webp",
  versaceYellow: "/home/icons/center_wallent_versace_yellow.webp",
  lancomePeach: "/home/icons/center_wallent_lancome_peach.webp",
  hermesOrange: "/home/icons/center_wallent_hermes_orange.webp",
  whiteBlue: "/home/icons/center_wallent_whiteBlue.webp",
  sk2: "/home/icons/center_wallent_sk2.webp",
  whiteYellow: "/home/icons/center_wallent_whiteYellow.webp",
  lightBrown: "/home/icons/center_wallent_lightBrow.webp",
  whiteOrange: "/home/icons/center_wallent_whiteOrang.webp",
  furlaBlue: "/home/icons/center_wallent_furlaBlue.webp",
  whitePink: "/home/icons/center_wallent_whitePink.webp",
  bvGreen: "/home/icons/center_wallent_bvGreen.webp",
  whiteBrown: "/home/icons/center_wallent_whiteBrown.webp",
  AnnaSuiPurple: "/home/icons/center_wallent_AnnaSuiPurple.webp",
  whitePurple: "/home/icons/center_wallent_whitePurple.webp",
  burgundyRed: "/home/icons/center_wallent_burgundyRed.webp",
  whiteDarkGreen: "/home/icons/center_wallent_whiteDarkGreen.webp"
};
const lockWallent = {
  black: "/home/icons/lock_wallet_black.webp",
  blue: "/home/icons/lock_wallet_blue.webp",
  whiteGreen: "/home/icons/lock_wallet_white_green.webp",
  purple: "/home/icons/lock_wallet_purple.webp",
  whiteRed: "/home/icons/lock_wallet_white_red.webp",
  oilyGreen: "/home/icons/lock_wallet_oily_green.webp",
  versaceYellow: "/home/icons/lock_wallet_versace_yellow.webp",
  lancomePeach: "/home/icons/lock_wallet_lancome_peach.webp",
  hermesOrange: "/home/icons/lock_wallet_hermes_orange.webp",
  whiteBlue: "/home/icons/lock_wallet_whiteBlue.webp",
  sk2: "/home/icons/lock_wallet_sk2.webp",
  whiteYellow: "/home/icons/lock_wallet_whiteYellow.webp",
  lightBrown: "/home/icons/lock_wallet_lightBrow.webp",
  whiteOrange: "/home/icons/lock_wallet_whiteOrang.webp",
  furlaBlue: "/home/icons/lock_wallet_furlaBlue.webp",
  whitePink: "/home/icons/lock_wallet_whitePink.webp",
  bvGreen: "/home/icons/lock_wallet_bvGreen.webp",
  whiteBrown: "/home/icons/lock_wallet_whiteBrown.webp",
  AnnaSuiPurple: "/home/icons/lock_wallet_AnnaSuiPurple.webp",
  whitePurple: "/home/icons/lock_wallet_whitePurple.webp",
  burgundyRed: "/home/icons/lock_wallet_burgundyRed.webp",
  whiteDarkGreen: "/home/icons/lock_wallet_whiteDarkGreen.webp"
};
const centarlBg = {
  black: "/home/centarl_bg_black.webp",
  blue: "/home/centarl_bg_blue.webp",
  whiteGreen: "/home/centarl_bg_white_green.webp",
  purple: "/home/centarl_bg_purple.webp",
  whiteRed: "/home/centarl_bg_white_red.webp",
  lancomePeach: "/home/centarl_bg_lancomePeach.webp",
  hermesOrange: "/home/centarl_bg_hermesOrange.webp",
  whiteBlue: "/home/centarl_bg_whiteBlue_1.webp",
  sk2: "/home/centarl_bg_sk22.webp",
  whiteYellow: "/home/centarl_bg_whiteYellow_2.webp",
  lightBrown: "/home/icons/centarl_bg_lightBrown.webp",
  whiteOrange: "/home/centarl_bg_whiteOrang.webp",
  furlaBlue: "/home/centarl_bg_furlaBlue.webp",
  whitePink: "/home/centarl_bg_whitePink.webp",
  bvGreen: "/home/centarl_bg_bvGreen.webp",
  whiteBrown: "/home/centarl_bg_whiteBrown.webp",
  AnnaSuiPurple: "/home/centarl_bg_AnnaSuiPurple.webp",
  whitePurple: "/home/centarl_bg_whitePurple.webp",
  oilyGreen: "/home/icons/centarl_bg_oilyGreen2.webp",
  burgundyRed: "/home/icons/centarl_bg_burgundyRed.webp",
  whiteDarkGreen: "/home/icons/centarl_bg_whiteDarkGreen.webp"
};
const Header = () => {
  const { info, theme } = useUserInfoStore();
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: joinClass(css.header), children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      Image,
      {
        className: css.imgBg,
        src: centarlBg[theme] || "/home/centarl_bg.webp"
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: css.centarl, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Image,
        {
          className: css.img,
          src: centerWallent[theme] || "/home/icons/center_wallent.webp"
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { children: trans("中心钱包") }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: joinClass(css.coin, mineCss.flexCenter), children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Image,
          {
            className: css.img,
            src: getCountryFlag(true)
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: customToFixed(info.balance) })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: css.centarl, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Image,
        {
          className: css.img,
          src: lockWallent[theme] || "/home/icons/lock_wallet.webp"
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { children: trans("锁定钱包") }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: joinClass(css.coin), children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Image,
          {
            className: css.img,
            src: getCountryFlag(true)
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: customToFixed(info.lock_amount) })
      ] })
    ] })
  ] });
};
const RightList = (props) => {
  const [list, setList] = reactExports.useState([]);
  reactExports.useEffect(() => {
    var _a;
    setList((_a = props.dataList) != null ? _a : []);
  }, [props.dataList]);
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: css.rightContainer, children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: css.rightContainerContent, children: list.map((item, index) => /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: css.rightItem, "data-id": item.id, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: joinClass(mineCss.flexItemCenter, css.first), children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Image, { className: css.img, src: "/game/logo/".concat(item.pic, ".webp") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: item.name })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: css.second, children: customToFixed(item.amount) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "div",
      {
        className: joinClass(
          css.maintained,
          item.maintained === 2 ? css.maintainedAvtive : ""
        ),
        children: /* @__PURE__ */ jsxRuntimeExports.jsx(Image, { src: "/home/icons/maintained.webp" })
      }
    )
  ] }, item.id)) }) });
};
const CentralWallet = () => {
  const { info, getUserBalanceByStore } = useUserInfoStore();
  const { games, gameSortMap, gameOpenMap } = useGameStore();
  const [leftList, setLeftList] = reactExports.useState([]);
  const [curId, setCurId] = reactExports.useState("-1");
  const [gameList, setGameList] = reactExports.useState([]);
  const getAllGames = async () => {
    const gamesLCount = games.reduce((prev, cur) => {
      if (cur.l) {
        return prev + cur.l.length;
      }
      return prev;
    }, 0);
    let _length = 0;
    const arr = [];
    for (let i = 0; i < games.length; i++) {
      if (games[i].l === null)
        continue;
      for (let j = 0; j < games[i].l.length; j++) {
        getPlatBalance(
          games[i].l[j].id,
          {},
          {
            noMsg: true
          }
        ).then((res) => {
          _length++;
          const [_data, _error] = res;
          const _o = {
            name: games[i].l[j].wallet_name,
            pic: games[i].l[j].name.split(" ")[0],
            parentId: games[i].id,
            id: games[i].l[j].id,
            amount: _data ? _data : 0,
            maintained: games[i].l[j].maintained
          };
          arr.push(_o);
          if (_length === gamesLCount) {
            setGameList(arr);
          }
        });
      }
    }
  };
  const oneClickRecycling = async () => {
    const [res, err] = await postRecallbalance();
    if (err) {
      Message.error(trans("回收失败"));
      return;
    }
    getUserBalanceByStore();
    getAllGames();
    Message.success(trans("回收成功"));
  };
  const curGameList = reactExports.useMemo(() => {
    if (!curId)
      return [];
    if (!gameList.length)
      return [];
    if (curId === "-1")
      return gameList;
    return gameList.filter((item) => item.parentId === curId);
  }, [curId, gameList]);
  reactExports.useEffect(() => {
    setLeftList([
      {
        value: "-1",
        label: "".concat(trans("全部")),
        IconsCom: TudoIcons
      },
      ...GameTabs.sort((a, b) => {
        return (a.sort || gameSortMap[a.type] || 0) - (b.sort || gameSortMap[b.type] || 0);
      }).filter((item) => {
        return item.type !== "热门" && item.type;
      }).map((item) => {
        var _a;
        if (!gameOpenMap[item.type] && gameTypeNames.indexOf(item.type) > -1)
          return {};
        return {
          label: item.text,
          icon: item.icon,
          value: (_a = games.find((game) => game.name === item.type)) == null ? void 0 : _a.id,
          IconsCom: item.IconsCom
        };
      })
    ]);
    getAllGames();
  }, [games]);
  reactExports.useEffect(() => {
    getUserBalanceByStore();
  }, []);
  return /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        id: "OneClickRecycling",
        className: css.displayNone,
        onClick: () => {
          oneClickRecycling();
        },
        children: trans("一键回收")
      }
    ),
    info && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Header, {}),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: joinClass(css.listContainer, mineCss.flex), children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(LeftNav, { className: css.left_nav, dataList: leftList, onChange: (id) => setCurId(id) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(RightList, { dataList: curGameList != null ? curGameList : [] })
      ] })
    ] })
  ] });
};
export {
  CentralWallet as default
};
